<!DOCTYPE html><html lang="ja" data-astro-cid-tljqxsdm> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="Astro v5.1.1"><!-- Canonical URL --><link rel="canonical" href="https://m2ym.github.com/posts/2021-06-29-writing-lisp-code-in-kakau/"><!-- Primary Meta Tags --><title>Kakau で Lisp コードを書いてみる - m2ymの雑記帳</title><meta name="title" content="Kakau で Lisp コードを書いてみる - m2ymの雑記帳"><meta name="description"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://m2ym.github.com/posts/2021-06-29-writing-lisp-code-in-kakau/"><meta property="og:title" content="Kakau で Lisp コードを書いてみる - m2ymの雑記帳"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://m2ym.github.com/posts/2021-06-29-writing-lisp-code-in-kakau/"><meta property="twitter:title" content="Kakau で Lisp コードを書いてみる - m2ymの雑記帳"><style>html{font-size:16px;margin:0;padding:0}body{margin:0;padding:0}main{margin:3rem auto;width:720px}#nav>ul{padding:0;list-style:none}#nav li{margin:12px 0}#nav a{color:#666;font-size:large;text-decoration:none}#nav a:hover{color:#000}.sr-only{border:0;padding:0;margin:0;position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);clip-path:inset(50%);white-space:nowrap}header[data-astro-cid-3ef6ksr2]{margin:0 auto;padding:1rem 0px;width:720px}nav[data-astro-cid-3ef6ksr2]{display:flex;gap:1rem}footer[data-astro-cid-sz7xmlte]{margin:0 auto;padding:1rem 0px;width:720px}.social-links[data-astro-cid-sz7xmlte]{display:flex;gap:1rem;padding:.5rem 0px}
.pub-date[data-astro-cid-tljqxsdm]{font-size:14px;color:#666;margin-bottom:2rem}
[data-astro-image]{width:100%;height:auto;object-fit:var(--fit);object-position:var(--pos);aspect-ratio:var(--w) / var(--h)}[data-astro-image=responsive]{max-width:calc(var(--w) * 1px);max-height:calc(var(--h) * 1px)}[data-astro-image=fixed]{width:calc(var(--w) * 1px);height:calc(var(--h) * 1px)}
</style></head> <body data-astro-cid-tljqxsdm> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2>Home</a> <a href="/posts" data-astro-cid-3ef6ksr2>Posts</a> <a href="/rss.xml" data-astro-cid-3ef6ksr2>RSS</a> </nav> </header>  <main data-astro-cid-tljqxsdm> <article data-astro-cid-tljqxsdm> <h1 data-astro-cid-tljqxsdm>Kakau で Lisp コードを書いてみる</h1> <div class="pub-date" data-astro-cid-tljqxsdm>Posted on <time datetime="2021-06-29T00:00:00.000Z"> Jun 29, 2021 </time></div> <p>（仮称 Lattic の正式名称が Kakau に決まりました。）</p>
<p>今回は半分ネタです。 Kakau を使ってコードを書くとどんな感じになるか気になったのでやってみました。言語はなんでも良かったのですが、構造化エディタの歴史に深い関わりのある Lisp を選択しました。まずはスクリーンキャプチャをどうぞ。^[ビュレットポイントや括弧は適宜無視してください]</p>
<p><img src="/images/2021-06-29-01.gif" alt=""></p>
<p>完成形のイメージは以下になります。</p>
<p><img src="/images/2021-06-29-02.png" alt=""></p>
<p>何をやっているか簡単に説明します。構造の操作に使っているキーは<code>Enter</code>, <code>Tab</code>, <code>Shift+Tab</code>, <code>Ctrl+i</code> の４つです。最初の３つはそれぞれ、改行、インデント、アンインデントを意味し、通常のアウトラインエディタと同じように動作します。最後の <code>Ctrl+i</code> は、（正確性を犠牲にして言えば）横方向版の改行です。これは他のエディタには存在しない Kakau 特有の操作です。</p>
<p>式を書く際は、<code>Ctrl+i</code>（横方向版の改行）と <code>Enter</code>（通常の改行） のどちらを使うかその都度選択しながら書いていきます。たとえば、</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e; overflow-x: auto;" tabindex="0" data-language="lisp"><code><span class="line"><span style="color:#24292E">(</span><span style="color:#D73A49">or</span><span style="color:#24292E"> (</span><span style="color:#005CC5">=</span><span style="color:#24292E"> n </span><span style="color:#005CC5">0</span><span style="color:#24292E">) (</span><span style="color:#005CC5">=</span><span style="color:#24292E"> n </span><span style="color:#005CC5">1</span><span style="color:#24292E">))</span></span></code></pre>
<p>のように一行に収めたいときは <code>Ctrl+i</code> を使い、</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e; overflow-x: auto;" tabindex="0" data-language="lisp"><code><span class="line"><span style="color:#24292E">(</span><span style="color:#005CC5">+</span><span style="color:#24292E"> (fib (</span><span style="color:#005CC5">-</span><span style="color:#24292E"> n </span><span style="color:#005CC5">1</span><span style="color:#24292E">))</span></span>
<span class="line"><span style="color:#24292E">   (fib (</span><span style="color:#005CC5">-</span><span style="color:#24292E"> n </span><span style="color:#005CC5">2</span><span style="color:#24292E">)))</span></span></code></pre>
<p>のようにパターンを表現したいときは <code>Enter</code> を使う、という具合になります。</p>
<p>経験上、 <code>Ctrl+i</code> と <code>Enter</code> を使い分けるには相当な慣れが必要です。そこで「アウトラインビュー」という機能を提供しています。この機能を使えば、<code>Ctrl+i</code> で作ったノードも「行」として表示・編集できます。上記の完成形をアウトラインビューで表示すると以下のようになります。</p>
<p><img src="/images/2021-06-29-03.png" alt=""></p>
<p>ちゃんと構造化されていることがわかります。^[小さなレベルで構造化されていないのは気にしない約束]ちなみに、<code>(defun fib (n)</code> で <code>fib</code> と <code>(n)</code> を二段インデントしているのは、それらが関数定義本体と揃うのを避けるためです。一方、 <code>(if (or (= n 0) (= n 1))</code> の <code>(or (= n 0) (= n 1))</code> は一段インデントなので then, else に揃っています。</p>
<p>最近はコードフォーマッタが主流になりつつあるようです。コードの見た目を手で調整するのは時代遅れなのかもしれません。しかしながら、だいぶ端折りますが、コードフォーマッタを利用する場合でも、複雑な見た目を制御可能にするには制御文字の拡張が不可欠です。そしてそれは Kakau が本質的に先取りしているものです。 Kakau によって、コードのみならずさまざまな表現の見た目が現実的なコストで制御可能になったのは、歴史的に見て非常に意義深いことではないかと考える昨今です。</p> </article> </main> <footer data-astro-cid-sz7xmlte> <div class="social-links" data-astro-cid-sz7xmlte> <a href="https://x.com/m2ym" data-astro-cid-sz7xmlte>X</a> <a href="https://github.com/m2ym" data-astro-cid-sz7xmlte>GitHub</a> </div>
&copy; 2025 m2ym
</footer>  </body></html>